<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ohio Mobile Detailing - Business Plan for Artem Tarasov</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    Chart.defaults.font.family = "'Inter', system-ui, -apple-system, Segoe UI, Roboto";
    Chart.defaults.font.size = 13;
    Chart.defaults.color = "#334155";
    Chart.defaults.plugins.legend.labels.boxWidth = 14;
    Chart.defaults.plugins.legend.labels.usePointStyle = true;
    Chart.defaults.plugins.tooltip.backgroundColor = "rgba(15, 23, 42, 0.9)";
    Chart.defaults.plugins.tooltip.borderColor = "rgba(255,255,255,0.1)";
    Chart.defaults.plugins.tooltip.borderWidth = 1;
    Chart.defaults.plugins.tooltip.padding = 10;
    Chart.defaults.animation.duration = 900;
    Chart.defaults.animation.easing = "easeOutQuart";
    Chart.defaults.responsive = true;
    Chart.defaults.maintainAspectRatio = false;
    </script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            color: #1d4ed8;
            border-color: #1d4ed8;
            background-color: #eff6ff;
        }
        .tab-content {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .tab-content.active {
            display: block;
        }
        .checklist-item input:checked + label .fa-circle {
            display: none;
        }
        .checklist-item input:checked + label .fa-check-circle {
            display: inline-block;
            color: #22c55e;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 2rem;
            border: 1px solid #888;
            width: 80%;
            max-width: 800px;
            border-radius: 0.5rem;
            position: relative;
        }
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
        }
        /* Custom slider styles */
        input[type=range] {
            -webkit-appearance: none;
            background: transparent;
            cursor: pointer;
            width: 100%;
        }
        input[type=range]::-webkit-slider-runnable-track {
            background: #dbeafe;
            height: 0.5rem;
            border-radius: 0.5rem;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            margin-top: -0.375rem;
            background-color: #2563eb;
            height: 1.25rem;
            width: 1.25rem;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }
        /* Sunburst Chart Styles */
        .sunburst-tooltip {
            position: absolute;
            text-align: center;
            padding: 0.5rem;
            background: #2d3748;
            color: white;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .sunburst-path {
            cursor: pointer;
            stroke: #fff;
            stroke-width: 1.5px;
        }
        .sunburst-path:hover {
            opacity: 0.8;
        }
        .sunburst-label {
            pointer-events: none;
            fill: white;
            text-shadow: 0 0 2px #000;
            font-size: 12px;
        }
        @media print {
            body * {
                visibility: hidden;
            }
            #invoice-modal-content, #invoice-modal-content * {
                visibility: visible;
            }
            #invoice-modal-content {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden">
        <header class="bg-gray-800 text-white p-6 md:p-8 relative overflow-hidden">
            <style>
              .bubble { position:absolute; border-radius:9999px; opacity:.15; filter:blur(1px); animation:float 12s linear infinite; }
              @keyframes float { from { transform: translateY(0) } to { transform: translateY(-120px) } }
            </style>
            <div class="bubble w-20 h-20 bg-cyan-300 left-10 top-10"></div>
            <div class="bubble w-24 h-24 bg-indigo-300 left-1/2 top-16"></div>
            <div class="bubble w-16 h-16 bg-emerald-300 right-10 top-24"></div>
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold">Ohio Mobile Detailing</h1>
                    <p class="mt-2 text-lg text-gray-300">An Interactive Business Launch Plan for Artem Tarasov</p>
                </div>
                <!-- Social Media Links -->
                <div class="flex space-x-4">
                    <a href="https://www.instagram.com/wrtemi?igsh=NTc4MTIwNjQ2YQ==" target="_blank" aria-label="Instagram" class="text-gray-400 hover:text-white transition transform hover:scale-105 hover:opacity-90"><i class="fa-brands fa-instagram fa-2x"></i></a>
                    <a href="#" target="_blank" aria-label="YouTube" class="text-gray-400 hover:text-white transition transform hover:scale-105 hover:opacity-90"><i class="fa-brands fa-youtube fa-2x"></i></a>
                    <a href="#" target="_blank" aria-label="TikTok" class="text-gray-400 hover:text-white transition transform hover:scale-105 hover:opacity-90"><i class="fa-brands fa-tiktok fa-2x"></i></a>
                </div>
            </div>
        </header>

        <main class="p-6 md:p-8">
            <section class="max-w-6xl mx-auto px-4 py-12">
              <h2 class="text-3xl font-semibold text-center mb-8">Why Choose Our Mobile Detailing</h2>
              <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-sm p-6 border hover:shadow-md transition">
                  <div class="text-3xl mb-3"><i class="fa-solid fa-spray-can-sparkles"></i></div>
                  <h3 class="font-semibold mb-1">Foam Cannon Wash</h3>
                  <p class="text-sm text-gray-600">Thick snow foam pre-wash for safe contact cleaning.</p>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 border hover:shadow-md transition">
                  <div class="text-3xl mb-3"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                  <h3 class="font-semibold mb-1">Paint Decon & Sealant</h3>
                  <p class="text-sm text-gray-600">Iron remover, clay bar, and synthetic sealant for gloss.</p>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-6 border hover:shadow-md transition">
                  <div class="text-3xl mb-3">🧹</div>
                  <h3 class="font-semibold mb-1">Interior Deep Clean</h3>
                  <p class="text-sm text-gray-600">Steam, hot-water extraction, and UV protectants.</p>
                </div>
              </div>
            </section>

            <!-- Tabs Navigation -->
            <div class="border-b border-gray-200 mb-6">
                <nav class="-mb-px flex flex-wrap gap-x-6 gap-y-2" aria-label="Tabs">
                    <button class="tab-button active group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm" data-tab="launch-plan">
                        <i class="fa-solid fa-rocket mr-2"></i> Launch Plan
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="market-analysis">
                        <i class="fa-solid fa-magnifying-glass-chart mr-2"></i> Market Analysis
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="legal">
                        <i class="fa-solid fa-gavel mr-2"></i> Legal & Compliance
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="operations">
                        <i class="fa-solid fa-gears mr-2"></i> Operations & Services
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="financials">
                        <i class="fa-solid fa-hand-holding-dollar mr-2"></i> Financials
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="templates">
                        <i class="fa-solid fa-file-lines mr-2"></i> Templates & Tools
                    </button>
                    <button class="tab-button group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="business-tools">
                        <i class="fa-solid fa-toolbox mr-2"></i> Business Tools
                    </button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div id="tab-content-container">
                <!-- Launch Plan Tab -->
                <div id="launch-plan" class="tab-content active">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">7-Day Accelerated Launch Plan</h2>
                    <!-- Audio Player Placeholder -->
                    <div class="bg-gray-100 p-4 rounded-lg mb-6">
                        <h3 class="font-semibold text-gray-700 mb-2"><i class="fa-solid fa-microphone-lines mr-2"></i>Audio Guide for the Launch Plan</h3>
                        <audio controls class="w-full">
                            <source src="media/Мобильный_автодетейлинг_в_Огайо__Как_запустить_премиум-сервис_и_не_утонуть_в__грязной__воде_.m4a" type="audio/mp4">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
                    <p class="text-gray-600 mb-6">This accelerated plan sequences critical tasks to ensure a fully operational launch within a week. Check off items as you complete them.</p>
                    <div class="space-y-4" id="launch-checklist">
                        <!-- Checklist items will be injected by JS -->
                    </div>
                </div>

                <!-- Market Analysis Tab -->
                <div id="market-analysis" class="tab-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Market & Competitive Landscape</h2>
                    <p class="text-gray-600 mb-6">Analysis of Cincinnati and Cleveland markets reveals a preference for professionalism and quality over low cost. The ideal customer is an affluent vehicle owner who values their time and automotive investment.</p>
                    
                    <!-- Video Section -->
                    <div class="mb-8">
                        <h3 class="font-bold text-lg text-gray-700 mb-4">Market Analysis — Video</h3>
                        <div class="aspect-w-16 aspect-h-9 bg-black rounded-lg overflow-hidden shadow-lg">
                           <video controls class="w-full h-full object-cover" poster="https://placehold.co/1600x900/1f2937/ffffff?text=Our+Services+in+Action">
                                <source src="media/The_Explainer__Your_Ohio_Mobile_Detailing_Blueprint.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>

                    <div class="mt-8">
                        <h3 class="font-bold text-lg text-gray-700 mb-4">Target Audience Profile</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                             <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="font-semibold text-gray-800 flex items-center"><i class="fa-solid fa-house-user mr-2 text-blue-600"></i>B2C: Affluent Residential</h4>
                                <p class="text-gray-600 mt-2">High-income households with premium or luxury vehicles. These clients value convenience, quality, and the protection of their automotive investments.</p>
                                <ul class="mt-4 space-y-2 text-sm">
                                    <li><span class="font-semibold">Key Demographics:</span> Households with income &gt; $100,000/year.</li>
                                    <li><span class="font-semibold">Primary Geographies:</span> Affluent zip codes in Cincinnati & Cleveland suburbs.</li>
                                    <li><span class="font-semibold">Vehicle Types:</span> Lexus, BMW, Mercedes-Benz, Porsche, Audi, and high-trim domestic SUVs/trucks.</li>
                                </ul>
                            </div>
                             <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="font-semibold text-gray-800 flex items-center"><i class="fa-solid fa-building mr-2 text-green-600"></i>B2B: Corporate Clients</h4>
                                <p class="text-gray-600 mt-2">Businesses with vehicle fleets that require regular, high-quality detailing to maintain brand image and protect asset value. Offers recurring revenue potential.</p>
                                 <ul class="mt-4 space-y-2 text-sm">
                                    <li><span class="font-semibold">Key Segments:</span> Car dealerships, corporate & rental fleets, executive transportation & limo services.</li>
                                    <li><span class="font-semibold">Value Proposition:</span> On-site service eliminates logistics of moving vehicles off-site.</li>
                                    <li><span class="font-semibold">Potential Targets:</span> Kings Automall (Cincinnati), Serpentini Chevrolet (Cleveland).</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                        <div>
                             <h3 class="font-bold text-lg text-gray-700 mb-2">Target Audience Breakdown</h3>
                             <div class="relative h-80">
                                <canvas id="audienceChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg text-gray-700 mb-2">Top Target Zip Codes by MHI</h3>
                            <div class="relative h-80">
                                <canvas id="zipCodeChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="font-bold text-lg text-gray-700 mb-2">Competitive Landscape: Full Detail Price Range Comparison</h3>
                        <div class="relative h-[500px]">
                            <canvas id="competitorPriceChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Legal & Compliance Tab -->
                <div id="legal" class="tab-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Legal & Compliance Checklist</h2>
                    <p class="text-gray-600 mb-6">Ensuring full compliance is critical. An LLC is strongly recommended for liability protection. Use this checklist to navigate registration, licensing, and insurance.</p>
                    <div class="space-y-4" id="legal-checklist">
                       <!-- Legal checklist items will be injected by JS -->
                    </div>
                </div>

                <!-- Operations & Services Tab -->
                <div id="operations" class="tab-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Service Packages & Pricing</h2>
                    <p class="text-gray-600 mb-6">A clear, tiered package structure simplifies the buying process and provides upsell opportunities. Prices are positioned for the premium segment of the market.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Essential Detail -->
                        <div class="border border-gray-200 rounded-lg p-6 flex flex-col">
                            <h3 class="text-xl font-bold text-gray-800">The Essential Detail</h3>
                            <p class="text-gray-500 mt-2 flex-grow">Perfect for regular maintenance to keep a vehicle in excellent condition.</p>
                            <div class="my-6">
                                <span class="text-4xl font-bold text-gray-900">$175</span>
                                <span class="text-gray-500">/ Sedan</span>
                            </div>
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Meticulous Hand Wash</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Wheel & Tire Cleaning</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Comprehensive Interior Vacuum</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Dash & Console Wipe Down</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Window Cleaning</li>
                            </ul>
                        </div>
                        <!-- Signature Detail -->
                        <div class="border-2 border-blue-600 rounded-lg p-6 flex flex-col relative">
                            <div class="absolute top-0 -translate-y-1/2 bg-blue-600 text-white px-3 py-1 text-sm font-semibold rounded-full">Most Popular</div>
                            <h3 class="text-xl font-bold text-gray-800">The Signature Detail</h3>
                            <p class="text-gray-500 mt-2 flex-grow">A deep clean plus a durable layer of protection to keep your car shining for months.</p>
                            <div class="my-6">
                                <span class="text-4xl font-bold text-gray-900">$275</span>
                                <span class="text-gray-500">/ Sedan</span>
                            </div>
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-center"><i class="fa-solid fa-star text-yellow-400 mr-2"></i> All Essential Services</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Paint Decontamination</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Wax or Paint Sealant</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Interior UV Protectant</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Door Jamb Cleaning</li>
                            </ul>
                        </div>
                        <!-- Ultimate Detail -->
                        <div class="border border-gray-200 rounded-lg p-6 flex flex-col">
                            <h3 class="text-xl font-bold text-gray-800">The Ultimate Detail</h3>
                            <p class="text-gray-500 mt-2 flex-grow">A complete rejuvenation service to restore a vehicle to near-showroom condition.</p>
                            <div class="my-6">
                                <span class="text-4xl font-bold text-gray-900">$450</span>
                                <span class="text-gray-500">/ Sedan</span>
                            </div>
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-center"><i class="fa-solid fa-crown text-amber-500 mr-2"></i> All Signature Services</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Clay Bar Treatment</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Single-Stage Machine Polish</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Full Interior Shampoo/Steam</li>
                                <li class="flex items-center"><i class="fa-solid fa-check text-green-500 mr-2"></i> Leather Deep Clean & Condition</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Financials Tab -->
                <div id="financials" class="tab-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Financial Planning & Projections</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="font-bold text-lg text-gray-700 mb-2">Startup Budget Breakdown</h3>
                            <div class="relative h-96">
                                <canvas id="budgetChart"></canvas>
                            </div>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg text-gray-700 mb-2">Annual Net Profit Projections (Pre-Tax)</h3>
                            <div class="relative h-96">
                                <canvas id="profitChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Templates & Tools Tab -->
                <div id="templates" class="tab-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Templates & Tools</h2>
                    <p class="text-gray-600 mb-6">Open = preview + auto-copy to clipboard.</p>

                    <!-- Обнови значения data-modal под фактические ID модалов -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <button class="modal-trigger group text-left bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition"
                                data-modal="modal-intake">
                            <div class="flex items-start gap-4">
                                <div class="shrink-0 rounded-lg p-3 bg-gradient-to-br from-blue-50 to-blue-100 text-blue-600">
                                    <i class="fa-solid fa-clipboard-list"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Customer Intake Form</div>
                                    <div class="text-xs text-gray-500 mt-1">Opens preview • auto-copies</div>
                                </div>
                                <i class="fa-regular fa-copy opacity-0 group-hover:opacity-100 transition"></i>
                            </div>
                        </button>

                        <button class="modal-trigger group text-left bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition"
                                data-modal="modal-agreement">
                            <div class="flex items-start gap-4">
                                <div class="shrink-0 rounded-lg p-3 bg-gradient-to-br from-emerald-50 to-emerald-100 text-emerald-600">
                                    <i class="fa-solid fa-file-signature"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Service Agreement</div>
                                    <div class="text-xs text-gray-500 mt-1">Opens preview • auto-copies</div>
                                </div>
                                <i class="fa-regular fa-copy opacity-0 group-hover:opacity-100 transition"></i>
                            </div>
                        </button>

                        <button class="modal-trigger group text-left bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition"
                                data-modal="modal-invoice-template">
                            <div class="flex items-start gap-4">
                                <div class="shrink-0 rounded-lg p-3 bg-gradient-to-br from-amber-50 to-amber-100 text-amber-600">
                                    <i class="fa-solid fa-file-invoice-dollar"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Invoice Template</div>
                                    <div class="text-xs text-gray-500 mt-1">Opens preview • auto-copies</div>
                                </div>
                                <i class="fa-regular fa-copy opacity-0 group-hover:opacity-100 transition"></i>
                            </div>
                        </button>

                        <button class="modal-trigger group text-left bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition"
                                data-modal="modal-flyer">
                            <div class="flex items-start gap-4">
                                <div class="shrink-0 rounded-lg p-3 bg-gradient-to-br from-fuchsia-50 to-fuchsia-100 text-fuchsia-600">
                                    <i class="fa-solid fa-bullhorn"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Promotional Flyer Copy</div>
                                    <div class="text-xs text-gray-500 mt-1">Opens preview • auto-copies</div>
                                </div>
                                <i class="fa-regular fa-copy opacity-0 group-hover:opacity-100 transition"></i>
                            </div>
                        </button>

                        <button class="modal-trigger group text-left bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition"
                                data-modal="modal-scripts">
                            <div class="flex items-start gap-4">
                                <div class="shrink-0 rounded-lg p-3 bg-gradient-to-br from-sky-50 to-sky-100 text-sky-600">
                                    <i class="fa-solid fa-phone-volume"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Regulatory Call Scripts</div>
                                    <div class="text-xs text-gray-500 mt-1">Opens preview • auto-copies</div>
                                </div>
                                <i class="fa-regular fa-copy opacity-0 group-hover:opacity-100 transition"></i>
                            </div>
                        </button>
                    </div>
                </div>
                
                <!-- Business Tools Content -->
                <div id="business-tools" class="tab-content">
                    <!-- Profitability Calculator -->
                    <div class="bg-gray-800 text-white p-8 rounded-2xl shadow-2xl mb-8">
                        <h2 class="text-3xl font-bold text-center mb-6">Interactive Profitability Calculator</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                            <div>
                                <label for="jobsPerMonth" class="block text-sm font-medium text-gray-300">Jobs per Month</label>
                                <input type="range" id="jobsPerMonth" min="1" max="100" value="40" class="mt-2">
                                <div class="text-center text-lg font-semibold mt-2" id="jobsPerMonthValue">40</div>
                            </div>
                            <div>
                                <label for="avgRevenue" class="block text-sm font-medium text-gray-300">Average Revenue per Job</label>
                                <input type="range" id="avgRevenue" min="150" max="600" value="315" step="5" class="mt-2">
                                <div class="text-center text-lg font-semibold mt-2" id="avgRevenueValue">$315</div>
                            </div>
                            <div>
                                <label for="fixedCosts" class="block text-sm font-medium text-gray-300">Monthly Fixed Costs</label>
                                <input type="range" id="fixedCosts" min="500" max="3000" value="1320" step="10" class="mt-2">
                                <div class="text-center text-lg font-semibold mt-2" id="fixedCostsValue">$1320</div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                            <div class="space-y-4">
                                <div class="bg-gray-700 p-4 rounded-lg">
                                    <p class="text-gray-400">Monthly Profit</p>
                                    <p class="text-3xl font-bold text-green-400" id="monthlyProfitResult">$8,990</p>
                                </div>
                                <div class="bg-gray-700 p-4 rounded-lg">
                                    <p class="text-gray-400">Annual Profit</p>
                                    <p class="text-3xl font-bold text-green-400" id="annualProfitResult">$107,880</p>
                                </div>
                            </div>
                            <div class="relative h-64">
                                <canvas id="profitabilityChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-12">Invoice Generator</h2>
                    <p class="text-gray-600 mb-6">A simple tool to quickly generate customer invoices.</p>
                    <div class="max-w-2xl mx-auto bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="customerName" class="block text-sm font-medium text-gray-700">Customer Name</label>
                                <input type="text" id="customerName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                            </div>
                            <div>
                                <label for="servicePackage" class="block text-sm font-medium text-gray-700">Service Package</label>
                                <select id="servicePackage" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                                    <option value="essential">The Essential Detail</option>
                                    <option value="signature">The Signature Detail</option>
                                    <option value="ultimate">The Ultimate Detail</option>
                                </select>
                            </div>
                            <div>
                                <label for="vehicleSize" class="block text-sm font-medium text-gray-700">Vehicle Size</label>
                                <select id="vehicleSize" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                                    <option value="sedan">Sedan</option>
                                    <option value="suv">SUV/Truck</option>
                                </select>
                            </div>
                             <div>
                                <label for="addOns" class="block text-sm font-medium text-gray-700">Add-on Price ($)</label>
                                <input type="number" id="addOns" placeholder="e.g., 50 for pet hair" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                            </div>
                             <div>
                                <label for="taxRate" class="block text-sm font-medium text-gray-700">Sales Tax Rate (%)</label>
                                <input type="number" id="taxRate" value="7.8" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                            </div>
                        </div>
                        <div class="mt-6">
                            <button id="generateInvoiceBtn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition">
                                Generate Invoice
                            </button>
                        </div>
                    </div>
                </div>


            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="modal-intake" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="flex items-center justify-between gap-3 mb-4 border-b pb-2 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold">Customer Intake & Liability Waiver Form</h3>
            </div>
            <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-auto max-h-[60vh] border border-gray-200 whitespace-pre-wrap font-mono cursor-pointer" title="Click to copy">
Customer Information
Name: ____________________ Phone: ____________________
Email: ____________________ Service Address: ____________________

Vehicle Information
Year: ______ Make: ____________ Model: ____________
Color: _________ License Plate: _________ VIN (Optional): ____________

Service Selection
[ ] The Essential Detail [ ] The Signature Detail [ ] The Ultimate Detail
Add-Ons: ____________________ Quoted Price: $_________

Pre-Service Vehicle Inspection
Please initial next to any known pre-existing damage.
___ Scratches/Scuffs: _____________________________________
___ Dents/Dings: _______________________________________
___ Rock Chips: ________________________________________
___ Curb Rash on Wheels: ________________________________
___ Interior Stains/Tears: ________________________________
___ Warning Lights on Dash: _____________________________

Terms of Service & Liability Waiver
1. Personal Belongings: The business is not responsible for any personal items left in the vehicle. Please remove all valuables.
2. Pre-Existing Damage: The business is not responsible for any pre-existing damage to the vehicle.
3. Service Limitations: Some stains or defects may not be fully removable.
4. Payment: Payment is due in full upon completion of the service.
5. Cancellation: We require 24 hours' notice for cancellations.

By signing below, I acknowledge that I have read and agree to the terms listed above.
Customer Signature: ____________________ Date: ____________
            </pre>
        </div>
    </div>
    
    <div id="modal-agreement" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="flex items-center justify-between gap-3 mb-4 border-b pb-2 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold">Service Agreement & Liability Waiver</h3>
            </div>
            <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-auto max-h-[60vh] border border-gray-200 whitespace-pre-wrap font-mono cursor-pointer" title="Click to copy">
This agreement outlines the terms of service between [Your Company Name] ("Service Provider") and the customer ("Client").

1.  **Service Description:** Service Provider will perform mobile auto detailing services as listed in the work order.
2.  **Payment Terms:** Client shall pay the total amount due upon completion of the work.
3.  **Client Responsibilities:** Client will provide access to the vehicle and, if applicable, water and electricity. Client should remove all personal items.
4.  **Environmental Compliance:** Service Provider will follow all laws regarding wastewater containment and disposal.
5.  **Liability Waiver:**
    * **Pre-Existing Conditions:** Service Provider is not responsible for any damage that existed prior to service. A pre-service inspection will be conducted.
    * **Incidental Damage:** Service Provider is released from liability for minor incidental damage that can occur during a normal detailing process, provided there is no negligence.
    * **Interior & Personal Items:** Client releases Service Provider from liability for any loss or damage to personal items left in the vehicle.
    * **Maximum Liability:** Except for cases of proven gross negligence, the maximum liability for any claims shall not exceed the amount Client paid for the service.
6.  **Cancellation Policy:** Client may cancel up to 24 hours before the appointment with no penalty. Late cancellations may incur a fee.

By signing the intake form, Client acknowledges reading and understanding this agreement.
            </pre>
        </div>
    </div>

    <div id="modal-invoice-template" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="flex items-center justify-between gap-3 mb-4 border-b pb-2 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold">Invoice Template</h3>
            </div>
            <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-auto max-h-[60vh] border border-gray-200 whitespace-pre-wrap font-mono cursor-pointer" title="Click to copy">
[Your Company Name] - Mobile Detailing
[Your Address] | [Your Phone] | [Your Email]

Invoice #: [Invoice #]
Date: [Date]

Bill To:
[Client Name]
[Client Address]

Vehicle Serviced:
[Year Make Model]
Plate: [Plate #]

------------------------------------------------------------------
Service Description              Qty    Unit Price    Line Total
------------------------------------------------------------------
[Service Package Name]             1      $[Price]      $[Price]
[Add-On 1, if any]                 1      $[Price]      $[Price]


                                            Subtotal:   $[Subtotal]
                                Sales Tax ([Rate]%):   $[Tax]
                                ----------------------------------
                                      TOTAL DUE:   $[Total]
------------------------------------------------------------------

Notes:
Thank you for your business! Please consider leaving us a review.
Payment is due upon receipt.
            </pre>
        </div>
    </div>

    <div id="modal-flyer" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="flex items-center justify-between gap-3 mb-4 border-b pb-2 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold">Promotional Flyer Copy</h3>
            </div>
            <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-auto max-h-[60vh] border border-gray-200 whitespace-pre-wrap font-mono cursor-pointer" title="Click to copy">
(Headline - Large, Bold Font)
A Showroom Shine, Delivered to Your Driveway.

(Sub-headline)
Professional Mobile Auto Detailing for Ohio's Most Discerning Car Owners.

(Image: A high-quality photo of a gleaming, detailed luxury car)

(Body Text)
Your vehicle is more than just transportation—it's an investment. At [Your Company Name], we provide a meticulous, professional detailing service that comes directly to your home or office. We use only premium products and proven techniques to restore your car's beauty, protect its value, and save you time.

Our Services Include:
- The Signature Detail: Our most popular package for a deep clean and long-lasting paint protection.
- The Ultimate Detail: A complete interior and exterior rejuvenation.
- Ceramic Coatings: The ultimate in paint protection.

(The Offer - In a standout box)
GRAND OPENING OFFER!
20% OFF Your First Signature or Ultimate Detail!

(Call to Action)
Ready for a flawless finish?
Book Online: [YourWebsite.com]
Call Us: [Your Phone Number]

(Footer)
Licensed & Insured | Serving the Greater Cincinnati & Cleveland Areas
Follow us on Instagram! @[YourInstagramHandle]
            </pre>
        </div>
    </div>
    
    <div id="modal-scripts" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="flex items-center justify-between gap-3 mb-4 border-b pb-2 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold">Regulatory Call Scripts</h3>
            </div>
            <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-auto max-h-[60vh] border border-gray-200 whitespace-pre-wrap font-mono cursor-pointer" title="Click to copy">
**Script 1: Calling a POTW (Wastewater Treatment Plant)**

"Hello, my name is Artem Tarasov. I'm starting a local mobile car detailing business. I'm calling to ensure I handle my wastewater in full compliance with your regulations.

When we wash cars, we collect all the wash water—typically 10-20 gallons per vehicle, containing biodegradable soap and dirt—instead of letting it run into storm drains.

Is it acceptable to dispose of that collected water into the sanitary sewer system here in [City Name]? For example, could I dump it down a utility sink at my home base? I saw the Ohio EPA guidance that said to get permission from the local POTW, so I'm reaching out for that permission or to know the proper procedure. Do I need a permit for this?"

**Script 2: Calling a Water Department for a Hydrant Permit**

"Hello, I'm trying to obtain information on getting a fire hydrant use permit for a small mobile detailing business. We sometimes need a water source on site. Could I speak with someone about temporary hydrant meters?

My name is Artem Tarasov from [Your Company Name]. I want to properly use water from hydrants when necessary. I understand there's a permit or rental process. Could you outline the costs—deposit, usage fees, rental fees—and the application process? I also want to confirm any rules about backflow preventers, winter usage, or required approvals from the local fire department."
            </pre>
        </div>
    </div>

    <div id="invoice-modal" class="modal">
        <div class="modal-content" id="invoice-modal-content">
            <span class="modal-close no-print">&times;</span>
            <div class="p-4">
                <h2 class="text-2xl font-bold text-center">Invoice</h2>
                <div class="flex justify-between items-center mt-4">
                    <div>
                        <h3 class="font-bold">Ohio Mobile Detailing</h3>
                        <p class="text-sm text-gray-600">Columbus, OH</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm">Invoice #: <span id="invoice-id"></span></p>
                        <p class="text-sm">Date: <span id="invoice-date"></span></p>
                    </div>
                </div>
                <div class="mt-6 border-t pt-4">
                    <h4 class="font-semibold">Bill To:</h4>
                    <p id="invoice-customer-name" class="text-gray-700"></p>
                </div>
                <div class="mt-6">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="p-2">Service Description</th>
                                <th class="p-2 text-right">Amount</th>
                            </tr>
                        </thead>
                        <tbody id="invoice-items">
                        </tbody>
                        <tfoot id="invoice-totals" class="font-bold">
                        </tfoot>
                    </table>
                </div>
                <div class="text-center mt-8 no-print">
                    <button id="printInvoiceBtn" class="bg-green-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-600 transition">
                        <i class="fa-solid fa-print mr-2"></i>Print Invoice
                    </button>
                </div>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let profitabilityChart;

            // Tab functionality
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabContents.forEach(content => {
                if (content.classList.contains('active')) {
                    content.style.opacity = 1;
                }
            });

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const activeTabId = button.dataset.tab;
                    tabContents.forEach(content => {
                        if (content.id === activeTabId) {
                            content.classList.add('active');
                            // trigger fade in
                            requestAnimationFrame(() => {
                                content.style.opacity = 1;
                            });
                        } else if (content.classList.contains('active')) {
                            // fade out and hide after transition
                            content.style.opacity = 0;
                            content.addEventListener('transitionend', function handler() {
                                content.classList.remove('active');
                                content.removeEventListener('transitionend', handler);
                            });
                        }
                    });
                });
            });

            // Checklist data
            const launchChecklistData = [
                { day: 1, task: "Entity & Licensing: Register LLC with Ohio Secretary of State. Apply for Ohio Transient Vendor's license." },
                { day: 2, task: "Compliance Foundations: Develop Wastewater Management Plan. Contact local POTW and water utility if needed." },
                { day: 3, task: "Insurance & Finance: Bind insurance policies (GL, Commercial Auto, etc.). Open business bank account." },
                { day: 4, task: "Equipment & Vehicle Setup: Acquire and install all detailing equipment in your vehicle. Conduct a dry run." },
                { day: 5, task: "SOPs & Training: Finalize Standard Operating Procedures. Assemble SDS Binder for all chemicals." },
                { day: 6, task: "Marketing Launch: Create Google Business Profile and a simple website. Prepare review request templates." },
                { day: 7, task: "Soft Launch & Review: Conduct a full detail for a friend/family member to validate all processes." },
            ];

            const legalChecklistData = [
                { id: 'legal1', task: "Form an LLC: File Articles of Organization (Form 533A) with Ohio SOS. Cost: $99." },
                { id: 'legal2', task: "Appoint a Statutory Agent for the LLC." },
                { id: 'legal3', task: "Obtain Federal EIN from the IRS (free online application)." },
                { id: 'legal4', task: "Get a Transient Vendor's License from the Ohio Dept. of Taxation. Cost: $25." },
                { id: 'legal5', task: "Confirm city-level license needs (especially Cleveland)." },
                { id: 'legal6', task: "Secure Commercial Auto Insurance (State minimum 25/50/25, but $1M recommended)." },
                { id: 'legal7', task: "Secure General Liability Insurance ($1M recommended)." },
                { id: 'legal8', task: "Secure Garagekeepers Liability Insurance (crucial for customer vehicle protection)." },
                { id: 'legal9', task: "Obtain Workers' Comp from Ohio BWC if hiring employees." },
                { id: 'legal10', task: "Develop Environmental Compliance Plan (Water reclamation/containment is essential)." },
            ];

            function renderChecklist(containerId, data, isGrouped) {
                const container = document.getElementById(containerId);
                let html = '';
                if (isGrouped) {
                    data.forEach(item => {
                        html += `
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="font-bold text-gray-700">Day ${item.day}</p>
                                <div class="checklist-item mt-2">
                                    <input type="checkbox" id="launch${item.day}" class="hidden" onchange="saveChecklistState()">
                                    <label for="launch${item.day}" class="flex items-center cursor-pointer text-gray-600">
                                        <i class="far fa-circle text-gray-400 mr-3"></i>
                                        <i class="fas fa-check-circle hidden text-gray-400 mr-3"></i>
                                        <span>${item.task}</span>
                                    </label>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    data.forEach(item => {
                         html += `
                            <div class="checklist-item bg-gray-50 p-4 rounded-lg">
                                <input type="checkbox" id="${item.id}" class="hidden" onchange="saveChecklistState()">
                                <label for="${item.id}" class="flex items-center cursor-pointer text-gray-600">
                                    <i class="far fa-circle text-gray-400 mr-3"></i>
                                    <i class="fas fa-check-circle hidden text-gray-400 mr-3"></i>
                                    <span>${item.task}</span>
                                </label>
                            </div>
                        `;
                    });
                }
                container.innerHTML = html;
            }

            renderChecklist('launch-checklist', launchChecklistData, true);
            renderChecklist('legal-checklist', legalChecklistData, false);
            
            window.saveChecklistState = function() {
                const states = {};
                document.querySelectorAll('.checklist-item input[type="checkbox"]').forEach(checkbox => {
                    states[checkbox.id] = checkbox.checked;
                });
                localStorage.setItem('detailingChecklistState', JSON.stringify(states));
            };

            window.loadChecklistState = function() {
                const savedStates = JSON.parse(localStorage.getItem('detailingChecklistState'));
                if (savedStates) {
                    Object.keys(savedStates).forEach(id => {
                        const checkbox = document.getElementById(id);
                        if (checkbox) {
                            checkbox.checked = savedStates[id];
                        }
                    });
                }
            };
            
            loadChecklistState();

            // Charts
            const audienceCtx = document.getElementById('audienceChart').getContext('2d');
            new Chart(audienceCtx, {
                type: 'doughnut',
                data: { labels: ['Affluent Residential (B2C)', 'Corporate Fleets (B2B)'], datasets: [{ label: 'Target Audience Focus', data: [70, 30], backgroundColor: ['#3b82f6', '#16a34a'], hoverOffset: 6 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '64%', plugins: { legend: { position: 'bottom' } } }
            });

            const zipCodeCtx = document.getElementById('zipCodeChart').getContext('2d');
            new Chart(zipCodeCtx, {
                type: 'bar',
                data: { labels: ['Terrace Park', 'Gates Mills', 'Indian Hill', 'Chagrin Falls', 'Hyde Park'], datasets: [{ label: 'Median Household Income ($)', data: [173750, 157132, 136406, 126698, 133213], backgroundColor: ['#1d4ed8', '#ef4444', '#1d4ed8', '#ef4444', '#1d4ed8'], borderRadius: 8, borderSkipped: false }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false, position: 'bottom' } }, scales: { x: { grid: { color: 'rgba(148,163,184,0.25)' }, ticks: { callback: function(value) { return '$' + value/1000 + 'k'; } } } } }
            });

            const competitorCtx = document.getElementById('competitorPriceChart').getContext('2d');
            new Chart(competitorCtx, {
                type: 'bar',
                data: { labels: ['All Things Fresh', 'Sharks Mobile', 'NuView Auto Salon', 'Prestige Mobile', 'Miracle Detail', 'Shine Masters', 'It\'s A Wash', 'OUR Signature', 'OUR Ultimate'], datasets: [{ label: 'Price Range ($)', data: [[190, 250], [200, 270], [250, 375], [324, 326], [350, 400], [250, 425], [524, 526], [275, 325], [450, 525]], backgroundColor: ['#a7f3d0', '#a7f3d0', '#a7f3d0', '#a7f3d0', '#a7f3d0', '#a7f3d0', '#a7f3d0', '#60a5fa', '#1d4ed8'], borderColor: ['#059669', '#059669', '#059669', '#059669', '#059669', '#059669', '#059669', '#1d4ed8', '#1e3a8a'], borderWidth: 1, borderSkipped: false, borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false, position: 'bottom' }, tooltip: { callbacks: { label: function(context) { const val = context.raw; if (val[1] - val[0] <= 2) { const price = Math.round((val[0] + val[1]) / 2); return `Price: $${price}`; } return `Range: $${val[0]} - $${val[1]}`; } } } }, scales: { x: { beginAtZero: true, ticks: { callback: function(value) { return '$' + value; } } } } }
            });
            
            const profitCtx = document.getElementById('profitChart').getContext('2d');
            new Chart(profitCtx, {
                type: 'bar',
                data: { labels: ['Pessimistic', 'Realistic', 'Optimistic'], datasets: [{ label: 'Annual Net Profit', data: [46020, 107880, 231600], backgroundColor: ['#fca5a5', '#6ee7b7', '#67e8f9'], borderColor: ['#ef4444', '#10b981', '#06b6d4'], borderWidth: 1, borderRadius: 8, borderSkipped: false }] },
                options: { indexAxis: 'y', scales: { x: { beginAtZero: true, ticks: { callback: function(value) { return '$' + value/1000 + 'k'; } } } }, responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false, position: 'bottom' } } }
            });
            
            // ===== Modal functionality (auto-copy, no header buttons) =====
            const modalTriggers = document.querySelectorAll('.modal-trigger');
            const modals = document.querySelectorAll('.modal');
            const modalCloses = document.querySelectorAll('.modal-close');
            const toastEl = document.getElementById('toast');

            async function copyTextToClipboard(text) {
                if (!text) return;
                try {
                    await navigator.clipboard.writeText(text);
                } catch (e) {
                    const ta = document.createElement('textarea');
                    ta.value = text;
                    ta.style.position = 'fixed';
                    ta.style.left = '-9999px';
                    document.body.appendChild(ta);
                    ta.focus(); ta.select();
                    try { document.execCommand('copy'); } catch(_) {}
                    document.body.removeChild(ta);
                }
            }

            let toastTimer;
            function showToast(msg = 'Copied to clipboard') {
                if (!toastEl) return;
                toastEl.textContent = msg;
                toastEl.classList.remove('hidden','opacity-0');
                toastEl.classList.add('opacity-100');
                clearTimeout(toastTimer);
                toastTimer = setTimeout(() => {
                    toastEl.classList.add('opacity-0');
                    setTimeout(() => toastEl.classList.add('hidden'), 250);
                }, 1300);
            }

            function openModalAndAutoCopy(modal) {
                if (!modal) return;
                modal.style.display = 'flex';
                const pre = modal.querySelector('pre');
                if (pre) {
                    const text = pre.innerText.trim();
                    copyTextToClipboard(text);
                    showToast();
                }
            }

            modalTriggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    const modal = document.getElementById(trigger.dataset.modal);
                    openModalAndAutoCopy(modal);
                });
            });

            modalCloses.forEach(close => {
                close.addEventListener('click', () => {
                    close.closest('.modal').style.display = 'none';
                });
            });

            window.addEventListener('click', (event) => {
                modals.forEach(modal => {
                    if (event.target === modal) modal.style.display = 'none';
                });
            });

            window.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    modals.forEach(m => m.style.display = 'none');
                }
            });

            // Повторное копирование по клику на текст шаблона
            document.querySelectorAll('.modal pre').forEach(pre => {
                pre.classList.add('bg-gray-50','border','border-gray-200','rounded','p-4','text-sm','leading-relaxed','whitespace-pre-wrap','font-mono','cursor-pointer');
                pre.setAttribute('title','Click to copy');
                pre.addEventListener('click', () => {
                    copyTextToClipboard(pre.innerText.trim());
                    showToast('Copied');
                });
            });

            // Invoice Generator Logic
            const generateInvoiceBtn = document.getElementById('generateInvoiceBtn');
            const invoiceModal = document.getElementById('invoice-modal');
            const prices = { essential: { sedan: 175, suv: 200 }, signature: { sedan: 275, suv: 325 }, ultimate: { sedan: 450, suv: 525 } };
            generateInvoiceBtn.addEventListener('click', () => {
                const customerName = document.getElementById('customerName').value;
                const servicePackage = document.getElementById('servicePackage').value;
                const vehicleSize = document.getElementById('vehicleSize').value;
                const addOns = parseFloat(document.getElementById('addOns').value) || 0;
                const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
                const basePrice = prices[servicePackage][vehicleSize];
                const subtotal = basePrice + addOns;
                const taxAmount = subtotal * (taxRate / 100);
                const total = subtotal + taxAmount;
                document.getElementById('invoice-id').textContent = Math.floor(1000 + Math.random() * 9000);
                document.getElementById('invoice-date').textContent = new Date().toLocaleDateString();
                document.getElementById('invoice-customer-name').textContent = customerName || 'Valued Customer';
                let itemsHtml = `<tr><td class="p-2">${document.querySelector(`#servicePackage option[value=${servicePackage}]`).textContent} (${vehicleSize.charAt(0).toUpperCase() + vehicleSize.slice(1)})</td><td class="p-2 text-right">$${basePrice.toFixed(2)}</td></tr>`;
                if (addOns > 0) { itemsHtml += `<tr><td class="p-2">Additional Services / Add-ons</td><td class="p-2 text-right">$${addOns.toFixed(2)}</td></tr>`; }
                document.getElementById('invoice-items').innerHTML = itemsHtml;
                const totalsHtml = `<tr><td class="p-2 text-right">Subtotal</td><td class="p-2 text-right">$${subtotal.toFixed(2)}</td></tr><tr><td class="p-2 text-right">Sales Tax (${taxRate}%)</td><td class="p-2 text-right">$${taxAmount.toFixed(2)}</td></tr><tr class="border-t-2 border-gray-300"><td class="p-2 text-right">Total Due</td><td class="p-2 text-right">$${total.toFixed(2)}</td></tr>`;
                document.getElementById('invoice-totals').innerHTML = totalsHtml;
                invoiceModal.style.display = 'flex';
            });
            document.getElementById('printInvoiceBtn').addEventListener('click', () => { window.print(); });

            // Profitability Calculator Logic
            const jobsSlider = document.getElementById('jobsPerMonth');
            const revenueSlider = document.getElementById('avgRevenue');
            const costsSlider = document.getElementById('fixedCosts');
            const jobsValue = document.getElementById('jobsPerMonthValue');
            const revenueValue = document.getElementById('avgRevenueValue');
            const costsValue = document.getElementById('fixedCostsValue');
            const monthlyProfitResult = document.getElementById('monthlyProfitResult');
            const annualProfitResult = document.getElementById('annualProfitResult');
            const profitabilityCtx = document.getElementById('profitabilityChart').getContext('2d');
            function formatCurrency(value) { return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(value); }
            function updateCalculator() {
                const jobs = parseInt(jobsSlider.value);
                const avgRevenue = parseInt(revenueSlider.value);
                const fixedCosts = parseInt(costsSlider.value);
                jobsValue.textContent = jobs;
                revenueValue.textContent = formatCurrency(avgRevenue);
                costsValue.textContent = formatCurrency(fixedCosts);
                const monthlyRevenue = jobs * avgRevenue;
                const monthlyCOGS = monthlyRevenue * 0.15;
                const monthlyFuel = jobs * 10;
                const totalMonthlyCosts = fixedCosts + monthlyCOGS + monthlyFuel;
                const monthlyProfit = monthlyRevenue - totalMonthlyCosts;
                const annualProfit = monthlyProfit * 12;
                monthlyProfitResult.textContent = formatCurrency(monthlyProfit);
                annualProfitResult.textContent = formatCurrency(annualProfit);
                profitabilityChart.data.datasets[0].data = [monthlyRevenue, totalMonthlyCosts];
                profitabilityChart.update();
            }
            profitabilityChart = new Chart(profitabilityCtx, {
                type: 'bar',
                data: { labels: ['Monthly Revenue', 'Monthly Costs'], datasets: [{ label: 'Amount ($)', data: [0, 0], backgroundColor: ['#22c55e', '#ef4444'], borderRadius: 8, borderSkipped: false }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false, position: 'bottom' } }, scales: { y: { beginAtZero: true, ticks: { color: '#9ca3af' } }, x: { ticks: { color: '#9ca3af' } } } }
            });
            [jobsSlider, revenueSlider, costsSlider].forEach(slider => { slider.addEventListener('input', updateCalculator); });
            updateCalculator();

            // D3 Sunburst Chart Logic
            const budgetChartCtx = document.getElementById('budgetChart').getContext('2d');
            new Chart(budgetChartCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Vehicle & Build-Out', 'Equipment', 'Supplies', 'Marketing & Admin', 'Legal & Insurance', 'Contingency'],
                    datasets: [{
                        label: 'Startup Budget',
                        data: [29500, 5300, 2500, 1490, 874, 5800],
                        backgroundColor: [
                            '#1d4ed8', '#3b82f6', '#60a5fa', '#93c5fd', '#bfdbfe', '#a7f3d0'
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            // Ensure each service card has an image or placeholder
            function ensureServiceCardImages() {
                document.querySelectorAll('.service-card').forEach(card => {
                    const img = card.querySelector('img');
                    if (!img || !img.getAttribute('src')) {
                        const placeholder = document.createElement('div');
                        placeholder.className = 'service-card-placeholder text-4xl text-center';
                        placeholder.textContent = '🚗';
                        if (img) {
                            img.replaceWith(placeholder);
                        } else {
                            card.prepend(placeholder);
                        }
                    }
                });
            }

            ensureServiceCardImages();
        });
    </script>
    <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-sm px-4 py-2 rounded-lg shadow z-[100] opacity-0 pointer-events-none transition hidden">
      Copied to clipboard
    </div>
</body>
</html>
